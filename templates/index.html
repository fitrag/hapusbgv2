<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Hapus Background</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          fontFamily: {
            sans: ['Poppins', 'sans-serif'],
          },
          colors: {
            primary: {
              50: '#f0f9ff',
              100: '#e0f2fe',
              200: '#bae6fd',
              300: '#7dd3fc',
              400: '#38bdf8',
              500: '#0ea5e9',
              600: '#0284c7',
              700: '#0369a1',
            },
            secondary: {
              500: '#8b5cf6',
              600: '#7c3aed',
              700: '#6d28d9',
            }
          },
          animation: {
            'bounce-slow': 'bounce 3s infinite',
          }
        }
      }
    }
  </script>
  <style>
    .gradient-bg {
      background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%);
    }

    .card-hover {
      transition: all 0.3s ease;
    }

    .card-hover:hover {
      transform: translateY(-5px);
      box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
    }

    .drop-animation {
      animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
    }

    @keyframes pulse {

      0%,
      100% {
        opacity: 1;
      }

      50% {
        opacity: .7;
      }
    }

    .modal {
      display: none;
      position: fixed;
      z-index: 1;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      overflow: auto;
      background-color: rgba(0, 0, 0, 0.4);
    }

    .modal-content {
      background-color: #fefefe;
      margin: 5% auto;
      padding: 20px;
      border: 1px solid #888;
      width: 80%;
      max-width: 600px;
    }

    .close {
      color: #aaa;
      font-size: 28px;
      font-weight: bold;
    }

    .close:hover,
    .close:focus {
      color: black;
      text-decoration: none;
      cursor: pointer;
    }

    .preview img {
      max-width: 100%;
      height: auto;
    }
  </style>
</head>

<body class="bg-gray-50 min-h-screen font-sans">
  <!-- Header -->
  <header class="bg-white py-6 sticky top-0 z-50 border-b border-gray-100">
    <div class="max-w-5xl mx-auto px-4">
      <div class="flex items-center justify-between">
        <div class="flex items-center">
          <div class="mr-2">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-primary-600" viewBox="0 0 20 20"
              fill="currentColor">
              <path fill-rule="evenodd"
                d="M4 2a2 2 0 00-2 2v11a3 3 0 106 0V4a2 2 0 00-2-2H4zm1 14a1 1 0 100-2 1 1 0 000 2zm5-1.757l4.9-4.9a2 2 0 000-2.828L13.485 5.1a2 2 0 00-2.828 0L10 5.757v8.486zM16 18H9.071l6-6H16a2 2 0 012 2v2a2 2 0 01-2 2z"
                clip-rule="evenodd" />
            </svg>
          </div>
          <div>
            <h1 class="text-2xl font-bold text-gray-800">
              <span class="text-primary-600">Hapus</span><span class="font-light">BG</span>
            </h1>
            <div class="flex items-center mt-1">
              <span class="text-xs text-gray-500 mr-2">100% Otomatis</span>
              <span class="bg-green-500 text-white text-xs px-1.5 py-0.5 rounded-sm font-medium">Gratis</span>
            </div>
          </div>
        </div>

        <nav class="hidden md:flex items-center space-x-1">
          <a href="#"
            class="px-3 py-2 text-sm text-gray-700 hover:text-primary-600 hover:bg-gray-50 rounded-md transition-colors duration-200">Beranda</a>
          <a href="#"
            class="px-3 py-2 text-sm text-gray-700 hover:text-primary-600 hover:bg-gray-50 rounded-md transition-colors duration-200">Tentang</a>
          <a href="#"
            class="px-3 py-2 text-sm text-gray-700 hover:text-primary-600 hover:bg-gray-50 rounded-md transition-colors duration-200">Blog</a>
          <a href="#"
            class="ml-2 px-4 py-2 text-sm bg-primary-500 text-white rounded-md hover:bg-primary-600 transition-colors duration-200 shadow-sm">Login</a>
        </nav>

        <button class="md:hidden text-gray-500 hover:text-gray-700 focus:outline-none">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
          </svg>
        </button>
      </div>
    </div>
  </header>

  <main class="max-w-5xl mx-auto px-4 py-8">
    <!-- Drop Area -->
    <div id="dropArea"
      class="w-full p-8 border-2 border-dashed border-primary-400 bg-white rounded-2xl mb-8 text-center hover:bg-primary-50 transition-all duration-300 cursor-pointer shadow-lg group relative overflow-hidden">
      <!-- Background pattern -->
      <div class="absolute inset-0 bg-gradient-to-br from-primary-50 to-white opacity-50 z-0"></div>

      <!-- Animated circles -->
      <div class="absolute -bottom-16 -right-16 w-32 h-32 bg-primary-200 rounded-full opacity-20 z-0"></div>
      <div class="absolute -top-8 -left-8 w-24 h-24 bg-secondary-200 rounded-full opacity-20 z-0"></div>

      <div class="flex flex-col items-center relative z-10">
        <!-- Animated icon container -->
        <div class="relative mb-6 group-hover:scale-110 transition-transform duration-300">
          <div
            class="absolute inset-0 bg-primary-100 rounded-full scale-110 group-hover:scale-125 transition-transform duration-300 opacity-30">
          </div>
          <svg xmlns="http://www.w3.org/2000/svg" class="h-20 w-20 text-primary-500" viewBox="0 0 24 24" fill="none"
            stroke="currentColor" stroke-width="1.5">
            <path stroke-linecap="round" stroke-linejoin="round"
              d="M9 13h6m-3-3v6m-9 1V7a2 2 0 012-2h6l2 2h6a2 2 0 012 2v8a2 2 0 01-2 2H5a2 2 0 01-2-2z" />
          </svg>
        </div>

        <h3
          class="text-xl font-semibold text-gray-700 mb-2 group-hover:text-primary-600 transition-colors duration-300">
          Unggah Gambar Anda</h3>
        <p class="text-base text-gray-600 mb-3 max-w-md">Drag & drop gambar ke sini untuk menghapus background secara
          instan</p>

        <div class="flex items-center text-sm text-gray-500 mb-4">
          <span class="px-2 py-1 bg-gray-100 rounded-md mr-2">JPG</span>
          <span class="px-2 py-1 bg-gray-100 rounded-md mr-2">PNG</span>
          <span class="px-2 py-1 bg-gray-100 rounded-md">JPEG</span>
        </div>

        <button
          class="mt-2 px-8 py-3 bg-primary-500 text-white rounded-full hover:bg-primary-600 transition-all duration-300 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-opacity-50 shadow-md hover:shadow-lg transform hover:-translate-y-1">
          <span class="flex items-center">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" viewBox="0 0 20 20" fill="currentColor">
              <path fill-rule="evenodd"
                d="M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM6.293 6.707a1 1 0 010-1.414l3-3a1 1 0 011.414 0l3 3a1 1 0 01-1.414 1.414L11 5.414V13a1 1 0 11-2 0V5.414L7.707 6.707a1 1 0 01-1.414 0z"
                clip-rule="evenodd" />
            </svg>
            Pilih Gambar
          </span>
        </button>
      </div>
      <input type="file" id="imageInput" accept="image/*" multiple class="hidden">
    </div>

    <!-- Processing Status -->
    <div id="processingStatus" class="mb-8 text-center hidden">
      <div class="relative">

        <!-- Main container -->
        <div
          class="relative flex items-center justify-center px-6 py-4 bg-gradient-to-r from-primary-500/10 to-primary-600/10 backdrop-blur-sm rounded-xl border border-primary-300/30 shadow-lg max-w-md mx-auto">
          <!-- Spinner with gradient -->
          <div class="relative mr-4">
            <div
              class="absolute inset-0 rounded-full bg-gradient-to-tr from-primary-400 to-secondary-500 blur-sm opacity-50 animate-pulse">
            </div>
            <svg class="relative animate-spin h-8 w-8 text-primary-500" xmlns="http://www.w3.org/2000/svg" fill="none"
              viewBox="0 0 24 24">
              <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="3"></circle>
              <path class="opacity-90" fill="currentColor"
                d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z">
              </path>
            </svg>
          </div>

          <!-- Text content -->
          <div class="text-left">
            <h3 class="font-medium text-primary-700 text-lg">Memproses Gambar</h3>
            <p class="text-primary-600/80 text-sm">Mohon tunggu sebentar, kami sedang menghapus background...</p>
          </div>

        </div>
      </div>
    </div>

    <!-- Download All Button -->
    <div class="flex justify-center mb-8">
      <button id="downloadAllBtn"
        class="group relative hidden overflow-hidden px-8 py-4 bg-gradient-to-r from-secondary-500 to-secondary-600 text-white rounded-xl hover:shadow-xl transition-all duration-300 transform hover:-translate-y-1 flex items-center">
        <!-- Background glow effect -->
        <div
          class="absolute inset-0 w-full h-full bg-secondary-400 blur-md opacity-0 group-hover:opacity-30 transition-opacity duration-300">
        </div>

        <!-- Icon container with animation -->
        <div class="relative mr-3 bg-white/20 rounded-full p-2 group-hover:scale-110 transition-transform duration-300">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
              d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4" />
          </svg>
        </div>

        <!-- Text with badge -->
        <div class="relative flex flex-col items-start">
          <span class="font-medium text-base">Download Semua Hasil</span>
          <span class="text-xs text-white/80">Format .zip terkompresi</span>
        </div>

      </button>
    </div>

    <!-- Cards for processed images -->
    <div id="cardsContainer" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6"></div>
  </main>

  <!-- Footer -->
  <footer class="bg-gray-900 text-white pt-12 pb-6">
    <div class="max-w-5xl mx-auto px-4">
      <!-- Footer Content -->
      <div class="grid grid-cols-1 md:grid-cols-3 gap-8 mb-8">
        <!-- Brand Section -->
        <div>
          <div class="flex items-center mb-4">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-primary-400 mr-2" viewBox="0 0 20 20"
              fill="currentColor">
              <path fill-rule="evenodd"
                d="M4 2a2 2 0 00-2 2v11a3 3 0 106 0V4a2 2 0 00-2-2H4zm1 14a1 1 0 100-2 1 1 0 000 2zm5-1.757l4.9-4.9a2 2 0 000-2.828L13.485 5.1a2 2 0 00-2.828 0L10 5.757v8.486zM16 18H9.071l6-6H16a2 2 0 012 2v2a2 2 0 01-2 2z"
                clip-rule="evenodd" />
            </svg>
            <h3 class="text-xl font-bold">
              <span class="text-primary-400">Hapus</span><span class="font-light">BG</span>
            </h3>
          </div>
          <p class="text-gray-400 text-sm mb-4">
            Layanan penghapus background gambar otomatis yang cepat, mudah, dan gratis. Dapatkan hasil terbaik dalam
            hitungan detik.
          </p>
          <div class="flex space-x-4">
            <a href="#" class="text-gray-400 hover:text-primary-400 transition-colors duration-300">
              <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="currentColor" viewBox="0 0 24 24">
                <path
                  d="M24 4.557c-.883.392-1.832.656-2.828.775 1.017-.609 1.798-1.574 2.165-2.724-.951.564-2.005.974-3.127 1.195-.897-.957-2.178-1.555-3.594-1.555-3.179 0-5.515 2.966-4.797 6.045-4.091-.205-7.719-2.165-10.148-5.144-1.29 2.213-.669 5.108 1.523 6.574-.806-.026-1.566-.247-2.229-.616-.054 2.281 1.581 4.415 3.949 4.89-.693.188-1.452.232-2.224.084.626 1.956 2.444 3.379 4.6 3.419-2.07 1.623-4.678 2.348-7.29 2.04 2.179 1.397 4.768 2.212 7.548 2.212 9.142 0 14.307-7.721 13.995-14.646.962-.695 1.797-1.562 2.457-2.549z" />
              </svg>
            </a>
            <a href="#" class="text-gray-400 hover:text-primary-400 transition-colors duration-300">
              <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="currentColor" viewBox="0 0 24 24">
                <path
                  d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.163 6.162 6.163 6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.21-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795 0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z" />
              </svg>
            </a>
            <a href="#" class="text-gray-400 hover:text-primary-400 transition-colors duration-300">
              <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="currentColor" viewBox="0 0 24 24">
                <path
                  d="M9 8h-3v4h3v12h5v-12h3.642l.358-4h-4v-1.667c0-.955.192-1.333 1.115-1.333h2.885v-5h-3.808c-3.596 0-5.192 1.583-5.192 4.615v3.385z" />
              </svg>
            </a>
          </div>
        </div>

        <!-- Links Section -->
        <div class="grid grid-cols-2 gap-4">
          <div>
            <h4 class="text-white font-medium mb-4">Layanan</h4>
            <ul class="space-y-2">
              <li><a href="#" class="text-gray-400 hover:text-primary-400 transition-colors duration-300 text-sm">Hapus
                  Background</a></li>
              <li><a href="#" class="text-gray-400 hover:text-primary-400 transition-colors duration-300 text-sm">Edit
                  Foto</a></li>
              <li><a href="#"
                  class="text-gray-400 hover:text-primary-400 transition-colors duration-300 text-sm">Kompresi
                  Gambar</a></li>
              <li><a href="#"
                  class="text-gray-400 hover:text-primary-400 transition-colors duration-300 text-sm">Konversi
                  Format</a></li>
            </ul>
          </div>
          <div>
            <h4 class="text-white font-medium mb-4">Perusahaan</h4>
            <ul class="space-y-2">
              <li><a href="#"
                  class="text-gray-400 hover:text-primary-400 transition-colors duration-300 text-sm">Tentang Kami</a>
              </li>
              <li><a href="#"
                  class="text-gray-400 hover:text-primary-400 transition-colors duration-300 text-sm">Kontak</a></li>
              <li><a href="#"
                  class="text-gray-400 hover:text-primary-400 transition-colors duration-300 text-sm">Blog</a></li>
              <li><a href="#"
                  class="text-gray-400 hover:text-primary-400 transition-colors duration-300 text-sm">Karir</a></li>
            </ul>
          </div>
        </div>

        <!-- Newsletter Section -->
        <div>
          <h4 class="text-white font-medium mb-4">Berlangganan Newsletter</h4>
          <p class="text-gray-400 text-sm mb-4">Dapatkan update dan tips terbaru seputar edit foto.</p>
          <form class="flex">
            <input type="email" placeholder="Email Anda"
              class="px-4 py-2 w-full rounded-l-lg focus:outline-none focus:ring-2 focus:ring-primary-500 text-gray-800 text-sm" />
            <button type="submit"
              class="bg-primary-500 hover:bg-primary-600 px-4 py-2 rounded-r-lg transition-colors duration-300">
              <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24"
                stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14 5l7 7m0 0l-7 7m7-7H3" />
              </svg>
            </button>
          </form>
        </div>
      </div>

      <!-- Divider -->
      <div class="border-t border-gray-800 my-6"></div>

      <!-- Copyright Section -->
      <div class="flex flex-col md:flex-row justify-between items-center">
        <p class="text-gray-500 text-sm">© 2023 HapusBG. Semua hak dilindungi.</p>
        <div class="flex space-x-6 mt-4 md:mt-0">
          <a href="#" class="text-gray-500 hover:text-gray-400 text-sm">Kebijakan Privasi</a>
          <a href="#" class="text-gray-500 hover:text-gray-400 text-sm">Syarat & Ketentuan</a>
          <a href="#" class="text-gray-500 hover:text-gray-400 text-sm">Bantuan</a>
        </div>
      </div>
    </div>
  </footer>

  <!-- Modal Editor -->
  <div id="editor-modal"
    class="modal hidden backdrop-blur-sm fixed inset-0 z-50 flex items-start justify-center pt-10 px-4 sm:pt-16">
    <div
      class="modal-content bg-white dark:bg-gray-800 rounded-xl shadow-xl border border-gray-100 dark:border-gray-700 p-0 w-full max-w-md mx-auto overflow-hidden transition-all duration-300 transform">
      <!-- Header -->
      <div class="bg-gradient-to-r from-primary-500 to-secondary-500 p-4 relative">
        <h2 class="text-white text-lg font-semibold">Edit Background</h2>
        <button
          class="absolute top-3 right-3 text-white hover:text-gray-200 focus:outline-none transition-transform duration-300 hover:rotate-90"
          onclick="closeEditorModal()">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
          </svg>
        </button>
      </div>

      <!-- Content -->
      <div class="p-4 max-h-[calc(90vh-120px)] overflow-y-auto">
        <!-- Color Picker -->
        <div class="mb-4">
          <label for="bg-color"
            class="block text-gray-700 dark:text-gray-300 font-medium mb-2 flex items-center text-sm">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-2 text-primary-500" viewBox="0 0 20 20"
              fill="currentColor">
              <path fill-rule="evenodd"
                d="M4 2a2 2 0 00-2 2v11a3 3 0 106 0V4a2 2 0 00-2-2H4zm1 14a1 1 0 100-2 1 1 0 000 2zm5-1.757l4.9-4.9a2 2 0 000-2.828L13.485 5.1a2 2 0 00-2.828 0L10 5.757v8.486zM16 18H9.071l6-6H16a2 2 0 012 2v2a2 2 0 01-2 2z"
                clip-rule="evenodd" />
            </svg>
            Pilih Warna Background
          </label>
          <div class="flex flex-wrap items-center gap-2">
            <input type="color" id="bg-color" onchange="changeBackgroundColor()"
              class="h-8 w-8 rounded cursor-pointer border-0 bg-transparent">
            <div class="flex flex-wrap gap-2">
              <button
                class="w-6 h-6 rounded-full bg-white border border-gray-300 focus:outline-none focus:ring-2 focus:ring-primary-500"
                onclick="setPresetColor('#FFFFFF')"></button>
              <button class="w-6 h-6 rounded-full bg-blue-500 focus:outline-none focus:ring-2 focus:ring-primary-500"
                onclick="setPresetColor('#3B82F6')"></button>
              <button class="w-6 h-6 rounded-full bg-green-500 focus:outline-none focus:ring-2 focus:ring-primary-500"
                onclick="setPresetColor('#10B981')"></button>
              <button class="w-6 h-6 rounded-full bg-red-500 focus:outline-none focus:ring-2 focus:ring-primary-500"
                onclick="setPresetColor('#EF4444')"></button>
              <button class="w-6 h-6 rounded-full bg-yellow-500 focus:outline-none focus:ring-2 focus:ring-primary-500"
                onclick="setPresetColor('#F59E0B')"></button>
            </div>
          </div>
        </div>

        <!-- Image Upload -->
        <div class="mb-4">
          <label for="bg-image"
            class="block text-gray-700 dark:text-gray-300 font-medium mb-2 flex items-center text-sm">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-2 text-primary-500" viewBox="0 0 20 20"
              fill="currentColor">
              <path fill-rule="evenodd"
                d="M4 3a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V5a2 2 0 00-2-2H4zm12 12H4l4-8 3 6 2-4 3 6z"
                clip-rule="evenodd" />
            </svg>
            Unggah Gambar Background
          </label>
          <div class="relative">
            <input type="file" id="bg-image" accept="image/*" onchange="changeBackgroundImage()" class="hidden">
            <button onclick="document.getElementById('bg-image').click()"
              class="w-full py-2 px-3 border border-gray-300 dark:border-gray-600 rounded-lg text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600 transition-colors duration-300 flex items-center justify-center text-sm">
              <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-2 text-primary-500" viewBox="0 0 20 20"
                fill="currentColor">
                <path fill-rule="evenodd"
                  d="M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM6.293 6.707a1 1 0 010-1.414l3-3a1 1 0 011.414 0l3 3a1 1 0 01-1.414 1.414L11 5.414V13a1 1 0 11-2 0V5.414L7.707 6.707a1 1 0 01-1.414 0z"
                  clip-rule="evenodd" />
              </svg>
              Pilih Gambar
            </button>
          </div>
        </div>

        <!-- Resize -->
        <div class="mb-4">
          <h3 class="text-gray-700 dark:text-gray-300 font-medium mb-2 flex items-center text-sm">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-2 text-primary-500" viewBox="0 0 20 20"
              fill="currentColor">
              <path
                d="M4 3a1 1 0 000 2h12a1 1 0 100-2H4zM3 7a1 1 0 011-1h2a1 1 0 110 2H5v6h2a1 1 0 110 2H4a1 1 0 01-1-1V7zm10 6h2v-6h-2a1 1 0 010-2h3a1 1 0 011 1v10a1 1 0 01-1 1h-3a1 1 0 010-2z" />
            </svg>
            Resize Gambar
          </h3>
          <div class="flex gap-2 items-center">
            <input type="number" id="resize-width" placeholder="Lebar"
              class="w-24 px-2 py-1 rounded border border-gray-300 text-sm" />
            <span class="text-gray-500">x</span>
            <input type="number" id="resize-height" placeholder="Tinggi"
              class="w-24 px-2 py-1 rounded border border-gray-300 text-sm" />
            <label class="flex items-center text-xs ml-2">
              <input type="checkbox" id="lock-aspect" checked class="mr-1"> Lock Ratio
            </label>
          </div>
        </div>

        <!-- Crop Section -->
        <div class="mb-4">
          <h3 class="text-gray-700 dark:text-gray-300 font-medium mb-2 flex items-center text-sm">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-2 text-primary-500" viewBox="0 0 20 20"
              fill="currentColor">
              <path fill-rule="evenodd"
                d="M4 3a1 1 0 00-1 1v2a1 1 0 102 0V5h2a1 1 0 100-2H4zm11 2a1 1 0 112 0v10a1 1 0 11-2 0V5zM6 17a1 1 0 100 2h10a1 1 0 100-2H6z"
                clip-rule="evenodd" />
            </svg>
            Crop Gambar
          </h3>
          <div class="flex gap-2">
            <button onclick="startCropper()"
              class="px-3 py-1.5 bg-blue-500 text-white rounded hover:bg-blue-600 text-sm transition">Mulai
              Crop</button>
            <button onclick="applyCrop()"
              class="px-3 py-1.5 bg-green-500 text-white rounded hover:bg-green-600 text-sm transition">Simpan
              Crop</button>
          </div>
        </div>

        <!-- Preview -->
        <div class="mb-4">
          <h3 class="text-gray-700 dark:text-gray-300 font-medium mb-2 flex items-center text-sm">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-2 text-primary-500" viewBox="0 0 20 20"
              fill="currentColor">
              <path d="M10 12a2 2 0 100-4 2 2 0 000 4z" />
              <path fill-rule="evenodd"
                d="M.458 10C1.732 5.943 5.522 3 10 3s8.268 2.943 9.542 7c-1.274 4.057-5.064 7-9.542 7S1.732 14.057.458 10zM14 10a4 4 0 11-8 0 4 4 0 018 0z"
                clip-rule="evenodd" />
            </svg>
            Preview
          </h3>
          <div class="bg-gray-100 dark:bg-gray-700 rounded-lg p-2 relative overflow-hidden">
            <div class="aspect-w-16 aspect-h-9 rounded-lg overflow-hidden shadow-md">
              <img id="image-preview" src="" alt="Preview" class="w-full h-full object-contain" />
            </div>
          </div>
        </div>

      </div>

      <!-- Footer -->
      <div
        class="bg-gray-50 dark:bg-gray-900 p-3 flex justify-end space-x-2 border-t border-gray-100 dark:border-gray-700">
        <button onclick="closeEditorModal()"
          class="px-3 py-1.5 bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors duration-300 font-medium text-sm">
          Batal
        </button>
        <button onclick="saveChanges()"
          class="px-3 py-1.5 bg-gradient-to-r from-primary-500 to-primary-600 text-white rounded-lg hover:from-primary-600 hover:to-primary-700 transition-colors duration-300 font-medium shadow-md hover:shadow-lg flex items-center text-sm">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1" viewBox="0 0 20 20" fill="currentColor">
            <path fill-rule="evenodd"
              d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z"
              clip-rule="evenodd" />
          </svg>
          Simpan
        </button>
        <button onclick="downloadEditedImage()"
          class="px-3 py-1.5 bg-gradient-to-r from-green-500 to-green-600 text-white rounded-lg hover:from-green-600 hover:to-green-700 transition-colors duration-300 font-medium shadow-md hover:shadow-lg flex items-center text-sm">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1" fill="none" viewBox="0 0 24 24"
            stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
              d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4" />
          </svg>
          Download
        </button>
      </div>
    </div>
  </div>


  <script src="https://unpkg.com/cropperjs@1.5.13/dist/cropper.min.js"></script>
  <link href="https://unpkg.com/cropperjs@1.5.13/dist/cropper.min.css" rel="stylesheet" />
  <script>
    const dropArea = document.getElementById('dropArea');
    const input = document.getElementById('imageInput');
    const container = document.getElementById('cardsContainer');
    const downloadAllBtn = document.getElementById('downloadAllBtn');
    const processingStatus = document.getElementById('processingStatus');

    let cropper;

    function startCropper() {
      const previewImg = document.getElementById('image-preview');

      if (cropper) {
        cropper.destroy();
      }

      cropper = new Cropper(previewImg, {
        aspectRatio: NaN,
        viewMode: 1,
      });
    }

    function applyCrop() {
      if (!cropper) return;

      const canvas = cropper.getCroppedCanvas();
      const croppedDataUrl = canvas.toDataURL();

      // Update the preview
      document.getElementById('image-preview').src = croppedDataUrl;

      // Destroy cropper instance
      cropper.destroy();
      cropper = null;

      // Optionally update original image input (bg-image) if needed
    }

    let totalFiles = 0;
    let processedFiles = 0;
    let zip = new JSZip();
    const zipFilesMap = new Map();

    let selectedImageUrl = '';

    function openEditorModal(imageUrl) {
      selectedImageUrl = imageUrl;
      document.getElementById('editor-modal').style.display = 'block';
      document.getElementById('image-preview').src = imageUrl;
    }

    function closeEditorModal() {
      document.getElementById('editor-modal').style.display = 'none';
    }

    function changeBackgroundColor() {
      const color = document.getElementById('bg-color').value;
      document.getElementById('image-preview').style.backgroundColor = color;
    }

    function changeBackgroundImage() {
      const file = document.getElementById('bg-image').files[0];
      if (file) {
        const reader = new FileReader();
        reader.onload = function (e) {
          document.getElementById('image-preview').style.backgroundImage = `url(${e.target.result})`;
        }
        reader.readAsDataURL(file);
      }
    }
    function setPresetColor(color) {
      document.getElementById('bg-color').value = color;
      changeBackgroundColor();
    }

    document.getElementById('image-preview').onload = function () {
      const image = this;
      document.getElementById('resize-width').value = image.naturalWidth;
      document.getElementById('resize-height').value = image.naturalHeight;
      updatePreviewSize();
    };


    document.getElementById('resize-width').addEventListener('input', function () {
      const lock = document.getElementById('lock-aspect').checked;
      const image = document.getElementById('image-preview');
      if (!lock) return updatePreviewSize();
      const ratio = image.naturalHeight / image.naturalWidth;
      document.getElementById('resize-height').value = Math.round(this.value * ratio);
      updatePreviewSize();
    });

    document.getElementById('resize-height').addEventListener('input', function () {
      const lock = document.getElementById('lock-aspect').checked;
      const image = document.getElementById('image-preview');
      if (!lock) return updatePreviewSize();
      const ratio = image.naturalWidth / image.naturalHeight;
      document.getElementById('resize-width').value = Math.round(this.value * ratio);
      updatePreviewSize();
    });

    function downloadEditedImage() {
      const image = document.getElementById('image-preview');
      const bgImageInput = document.getElementById('bg-image');
      const bgColor = document.getElementById('bg-color').value;

      // Ambil nilai resize (fallback ke ukuran asli jika kosong)
      const width = parseInt(document.getElementById('resize-width').value) || image.naturalWidth;
      const height = parseInt(document.getElementById('resize-height').value) || image.naturalHeight;

      const canvas = document.createElement('canvas');
      const ctx = canvas.getContext('2d');
      canvas.width = width;
      canvas.height = height;

      const drawAndDownload = (bgDrawFn) => {
        bgDrawFn(); // gambar background
        ctx.drawImage(image, 0, 0, width, height); // gambar utama
        canvas.toBlob(function (blob) {
          const link = document.createElement('a');
          link.href = URL.createObjectURL(blob);
          link.download = 'edited_image.png';
          link.click();
        }, 'image/png');
      };

      if (bgImageInput.files && bgImageInput.files[0]) {
        const reader = new FileReader();
        reader.onload = function (e) {
          const bgImg = new Image();
          bgImg.onload = function () {
            drawAndDownload(() => {
              ctx.drawImage(bgImg, 0, 0, width, height);
            });
          };
          bgImg.src = e.target.result;
        };
        reader.readAsDataURL(bgImageInput.files[0]);
      } else {
        drawAndDownload(() => {
          ctx.fillStyle = bgColor;
          ctx.fillRect(0, 0, width, height);
        });
      }
    }
    function updatePreviewSize() {
      const img = document.getElementById('image-preview');
      const width = parseInt(document.getElementById('resize-width').value);
      const height = parseInt(document.getElementById('resize-height').value);

      if (width && height) {
        img.style.width = `${width}px`;
        img.style.height = `${height}px`;
      } else {
        img.style.width = 'auto';
        img.style.height = 'auto';
      }
    }


    function saveChanges() {
      const newBackground = document.getElementById('image-preview').style.backgroundImage || document.getElementById('image-preview').style.backgroundColor;
      const previewImage = document.getElementById('image-preview');
      previewImage.style.backgroundImage = newBackground;
      closeEditorModal();
    }// Untuk melacak file yang tersimpan di ZIP

    dropArea.addEventListener('click', () => input.click());
    dropArea.addEventListener('dragover', (e) => {
      e.preventDefault();
      dropArea.classList.add('bg-primary-100');
      dropArea.classList.add('border-primary-500');
    });
    dropArea.addEventListener('dragleave', () => {
      dropArea.classList.remove('bg-primary-100');
      dropArea.classList.remove('border-primary-500');
    });
    dropArea.addEventListener('drop', (e) => {
      e.preventDefault();
      dropArea.classList.remove('bg-primary-100');
      dropArea.classList.remove('border-primary-500');
      handleFiles(e.dataTransfer.files);
    });
    input.addEventListener('change', () => {
      handleFiles(input.files);
    });

    async function handleFiles(files) {
      if (files.length === 0) return;

      totalFiles = files.length;
      processedFiles = 0;
      zip = new JSZip();
      zipFilesMap.clear();
      container.innerHTML = ''; // Hapus semua card sebelumnya
      processingStatus.classList.remove('hidden');
      downloadAllBtn.classList.add('hidden');

      for (const file of files) {
        const card = document.createElement('div');
        card.className = 'bg-white p-4 rounded-lg shadow-md flex flex-col items-center card-hover';
        card.innerHTML = `
          <p class="text-sm font-medium text-gray-700 mb-2">${file.name}</p>
          <div class="relative w-full pt-[100%] mb-3">
            <div class="absolute inset-0 flex items-center justify-center">
              <div class="w-16 h-16 border-4 border-primary-500 border-t-transparent rounded-full animate-spin"></div>
            </div>
          </div>
          <p class="text-xs text-gray-500">Menghapus background...</p>
        `;
        container.appendChild(card);

        const formData = new FormData();
        formData.append('image', file);

        try {
          const res = await fetch('/process-single', {
            method: 'POST',
            body: formData
          });

          const blob = await res.blob();
          const filename = `processed_${Date.now()}_${Math.floor(Math.random() * 10000)}.png`;
          zip.file(filename, blob);
          zipFilesMap.set(filename, blob);

          const url = URL.createObjectURL(blob);
          card.setAttribute('data-filename', filename);
          card.innerHTML = `
            <div class="relative w-full pt-[100%] mb-3 overflow-hidden rounded-lg">
              <img src="${url}" alt="Processed" class="absolute inset-0 w-full h-full object-cover">
            </div>
            <div class="flex space-x-2 w-full">
              <a href="${url}" download="${filename}"
                class="flex-1 px-3 py-2 bg-primary-500 text-white text-sm rounded-lg hover:bg-primary-600 transition-colors duration-300 text-center">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 inline-block mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4" />
                </svg>
                Download
              </a>
              <button class="px-3 py-2 bg-red-500 text-white text-sm rounded-lg hover:bg-red-600 transition-colors duration-300" onclick="deleteImage(this)">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 inline-block" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                </svg>
              </button>
              <button class="px-3 py-2 bg-yellow-500 text-white text-sm rounded-lg hover:bg-yellow-600 transition-colors duration-300" onclick="openEditorModal('${url}')">
                Edit
              </button>
            </div>
          `;
        } catch (err) {
          card.innerHTML = `
            <div class="p-4 bg-red-50 rounded-lg text-center">
              <svg xmlns="http://www.w3.org/2000/svg" class="h-10 w-10 text-red-500 mx-auto mb-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
              </svg>
              <p class="text-red-600 text-sm">Gagal memproses ${file.name}</p>
            </div>
          `;
        }

        processedFiles++;
        if (processedFiles === totalFiles) {
          processingStatus.classList.add('hidden');
          downloadAllBtn.classList.remove('hidden');
        }
      }

      input.value = '';
    }

    function deleteImage(button) {
      const card = button.closest('div.card-hover');
      const filename = card.getAttribute('data-filename');
      if (filename) {
        zip.remove(filename);
        zipFilesMap.delete(filename);
      }
      card.remove();

      if (container.childElementCount === 0) {
        downloadAllBtn.classList.add('hidden');
      }
    }

    downloadAllBtn.addEventListener('click', () => {
      const newZip = new JSZip();
      for (let [filename, blob] of zipFilesMap.entries()) {
        newZip.file(filename, blob);
      }
      newZip.generateAsync({ type: 'blob' }).then(function (content) {
        const link = document.createElement('a');
        link.href = URL.createObjectURL(content);
        link.download = 'processed_images.zip';
        link.click();
      });
    });
  </script>

</body>

</html>